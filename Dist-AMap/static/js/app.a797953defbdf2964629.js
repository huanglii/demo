webpackJsonp([1],{"+aT9":function(t,e){t.exports=AMap},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var r=i("VU/8")({name:"App"},n,!1,function(t){i("gNwa")},null,null).exports,a=i("/ocq"),c=i("mvHQ"),o=i.n(c),l=i("+aT9"),d=i.n(l),u=i("lDdF"),p=i.n(u),v=i("a4Lr"),f=i.n(v),h=void 0,g=void 0,y=[],m={name:"aMap",data:function(){return{province:"",city:"",district:"",street:"",provinceList:[],cityList:[],districtList:[],streetList:[],toWGS:!1}},methods:{init:function(){(h=new d.a.Map("amap-container",{zoom:14,mapStyle:"amap://styles/whitesmoke"})).setCenter([116.397428,39.90923]),d.a.service("AMap.DistrictSearch",function(){g=new d.a.DistrictSearch({subdistrict:1,showbiz:!1})}),this.searchDistrict("中国")},getData:function(t,e,i){if(e&&this.clearSelectList(e),t.boundaries){y.push({code:t.adcode,name:t.name,boundaries:t.boundaries});for(var s=t.boundaries.length,n=0;n<s;n++){new d.a.Polygon({strokeWeight:1,strokeColor:"#CC66CC",fillColor:"#CCF3FF",fillOpacity:.5,path:t.boundaries[n]}).setMap(h)}h.setFitView()}i||this.addSubList(t.adcode,t.districtList)},clearSelectList:function(t){var e=this;"province"===t?(e.cityList=[],e.city="",e.districtList=[],e.district="",e.streetList=[],e.street=""):"city"===t?(e.districtList=[],e.district="",e.streetList=[],e.street=""):"district"===t&&(e.streetList=[],e.street="")},addSubList:function(t,e){var i=this,s=e[0].level,n={adcode:t,name:"全部"};"province"===s?(i.provinceList=e,i.provinceList.unshift(n)):"city"===s?(i.cityList=e,i.cityList.unshift(n)):"district"===s?(i.districtList=e,i.districtList.unshift(n)):"street"===s&&(i.streetList=e,i.streetList.unshift(n))},search:function(t,e){var i=this;if(h.clearMap(),y=[],g.setLevel(e),g.setExtensions("all"),"province"===e&&t.endsWith("100000"))for(var s=1;s<i.provinceList.length;s++){var n=i.provinceList[s].adcode;i.searchDistrict(n,e,!0)}else if("city"===e&&t.endsWith("0000"))for(var r=1;r<i.cityList.length;r++){var a=i.cityList[r].adcode;i.searchDistrict(a,e,!0)}else if("district"===e&&t.endsWith("00"))for(var c=1;c<i.districtList.length;c++){var o=i.districtList[c].adcode;i.searchDistrict(o,e,!0)}else i.searchDistrict(t,e,!1)},searchDistrict:function(t,e,i){var s=this,n=s.$loading({});g.search(t,function(t,r){n.close(),"complete"===t&&s.getData(r.districtList[0],e,i)})},downloadGeoJson:function(){var t=y;if(0!==t.length){var e=new Blob([o()(this.getGeoJson(t))],{type:"text/plain;charset=utf-8"});p.a.saveAs(e,"coods.json")}else this.$message({type:"error",center:!0,message:"当前未选择城市，无法下载"})},getGeoJson:function(t){for(var e={type:"FeatureCollection",features:[]},i=0;i<t.length;i++){var s=t[i],n=[],r={type:"Feature",properties:{code:s.code,name:s.name},geometry:{type:"Polygon",coordinates:[n]}},a=s.boundaries;if(a.length>1){r.geometry.type="MultiPolygon";for(var c=0;c<a.length;c++){n[c]=[];for(var o=0;o<a[c].length;o++){var l=a[c][o];n[c].push(this.toWGS?f.a.gcj2wgs(l.lng,l.lat):[l.lng,l.lat])}}}else for(var d=0;d<a[0].length;d++){var u=a[0][d];n.push(this.toWGS?f.a.gcj2wgs(u.lng,u.lat):[u.lng,u.lat])}e.features.push(r)}return e}},mounted:function(){this.init()}},L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{attrs:{id:"amap-container"}}),t._v(" "),i("div",{staticClass:"citySelect-container"},[i("el-row",[i("el-select",{attrs:{placeholder:"请选择省"},on:{change:function(e){t.search(t.province,"province")}},model:{value:t.province,callback:function(e){t.province=e},expression:"province"}},t._l(t.provinceList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}))],1),t._v(" "),i("el-row",[i("el-select",{attrs:{placeholder:"请选择市"},on:{change:function(e){t.search(t.city,"city")}},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},t._l(t.cityList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}))],1),t._v(" "),i("el-row",[i("el-select",{attrs:{placeholder:"请选择区"},on:{change:function(e){t.search(t.district,"district")}},model:{value:t.district,callback:function(e){t.district=e},expression:"district"}},t._l(t.districtList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}))],1),t._v(" "),i("el-row",[i("el-select",{attrs:{placeholder:"请选择街道"},on:{change:function(e){t.search(t.street,"street")}},model:{value:t.street,callback:function(e){t.street=e},expression:"street"}},t._l(t.streetList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}))],1),t._v(" "),i("el-row",[i("el-col",{staticStyle:{"text-align":"left"},attrs:{span:12}},[i("el-checkbox",{attrs:{label:"转WGS",border:""},model:{value:t.toWGS,callback:function(e){t.toWGS=e},expression:"toWGS"}})],1),t._v(" "),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadGeoJson}},[t._v("下 载")])],1)],1)],1)])},staticRenderFns:[]};var b=i("VU/8")(m,L,!1,function(t){i("VHT3")},"data-v-6d1cf986",null).exports;s.default.use(a.a);var w=new a.a({routes:[{path:"/",name:"aMap",component:b}]}),S=i("zL8q"),_=i.n(S);i("tvR6");s.default.config.productionTip=!1,s.default.use(_.a),new s.default({el:"#app",router:w,components:{App:r},template:"<App/>"})},VHT3:function(t,e){},gNwa:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.a797953defbdf2964629.js.map